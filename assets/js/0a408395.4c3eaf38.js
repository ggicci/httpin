"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[50],{2332:(e,t,n)=>{n.d(t,{Z:()=>u});var i=function(e,t,n,i){return new(n||(n=Promise))((function(r,o){function s(e){try{c(i.next(e))}catch(t){o(t)}}function a(e){try{c(i.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((i=i.apply(e,t||[])).next())}))};class r{constructor(e="/goplay"){this.proxyUrl=e}raiseForStatus(e){return i(this,void 0,void 0,(function*(){if(!e.ok){const t=yield e.text();throw new Error(t?e.statusText+": "+t:e.statusText)}}))}compile(e,t){return i(this,void 0,void 0,(function*(){const n=new FormData;n.append("version","2"),n.append("withVet","true"),n.append("body",e);const i=yield fetch(`${this.proxyUrl}/_/compile?backend=${t||""}`,{method:"POST",body:n});return yield this.raiseForStatus(i),yield i.json()}))}renderCompile(e,t,n){return i(this,void 0,void 0,(function*(){e.replaceChildren(this.renderMessage("system","Waiting for remote server..."));const i=yield this.compile(t,n);if(e.replaceChildren(),""!=i.Errors)return e.appendChild(this.renderMessage("error",i.Errors)),void e.appendChild(this.renderMessage("system","\nGo build failed."));for(const t of i.Events||[])e.appendChild(yield this.renderEvent(t));e.appendChild(this.renderMessage("system","\nProgram exited."))}))}renderEvent(e){return i(this,void 0,void 0,(function*(){var t;return e.Delay>=0&&(yield(t=e.Delay/1e6,new Promise((e=>setTimeout(e,t))))),this.renderMessage(e.Kind,e.Message)}))}renderMessage(e,t){const n=document.createElement("span");return n.classList.add(e),n.innerText=t,n}share(e,t){return i(this,void 0,void 0,(function*(){const n=yield fetch(`${this.proxyUrl}/_/share`,{method:"POST",body:e});yield this.raiseForStatus(n);const i="https://go.dev/play/p/"+(yield n.text());return t?`${i}?v=${t}`:i}))}}var o=n(4464),s=n(7294);const a="toolbar_uIxz",c="button_yMrS",l="hidden_X41c",p="https://goplay.ggicci.me",d=e=>{const{children:t,onClick:n}=e;return s.createElement("button",{className:c,onClick:n},t)},u=e=>{const{children:t}=e,n=s.useRef(null),i=s.useRef(null),c=t&&t.props&&"pre"===t.props.mdxType&&t,u=c&&c.props&&c.props.children;if(!u||"code"!==u.props.mdxType)return s.createElement("div",null,"GoPlay: the wrapped data is not a codeblock.");if(!/\blanguage-go\b/.test(u&&u.props.className))return s.createElement("div",null,"GoPlay: only go code supported.");return s.createElement(s.Fragment,null,t,s.createElement("div",{ref:n,className:l},s.createElement(o.Z,{language:"text"},s.createElement("div",{ref:i}))),s.createElement("div",{className:a},s.createElement(d,{onClick:function(){if(i.current){const e=new r(p);n.current.classList.remove(l),e.renderCompile(i.current,u.props.children.trim())}}},"Run"),s.createElement(d,{onClick:async function(){const e=new r(p),t=await e.share(u.props.children.trim());window.open(t,"_blank")}},"Try it yourself \u21e2")))}},845:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>p});var i=n(7462),r=(n(7294),n(3905)),o=n(2332);const s={sidebar_position:1},a="go-chi/chi",c={unversionedId:"integrations/gochi",id:"integrations/gochi",title:"go-chi/chi",description:"go-chi/chi is",source:"@site/docs/integrations/gochi.mdx",sourceDirName:"integrations",slug:"/integrations/gochi",permalink:"/httpin/integrations/gochi",draft:!1,editUrl:"https://github.com/ggicci/httpin/edit/documentation/docs/docs/integrations/gochi.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1},sidebar:"docsSidebar",previous:{title:"net/http",permalink:"/httpin/integrations/http"},next:{title:"gorilla/mux \ud83e\udd8d",permalink:"/httpin/integrations/gorilla"}},l={},p=[{value:"Integrations",id:"integrations",level:2},{value:"Run Demo",id:"run-demo",level:2}],d={toc:p},u="wrapper";function h(e){let{components:t,...n}=e;return(0,r.kt)(u,(0,i.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"go-chichi"},"go-chi/chi"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/go-chi/chi"},(0,r.kt)("strong",{parentName:"a"},"go-chi/chi"))," is"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"a lightweight, idiomatic and composable router for building Go HTTP services.")),(0,r.kt)("h2",{id:"integrations"},"Integrations"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Chain ",(0,r.kt)("inlineCode",{parentName:"li"},"httpin.NewInput")," middleware with ",(0,r.kt)("inlineCode",{parentName:"li"},"chi.With")," method"),(0,r.kt)("li",{parentName:"ol"},"Enable ",(0,r.kt)("inlineCode",{parentName:"li"},"path")," Directive by using ",(0,r.kt)("inlineCode",{parentName:"li"},"chi.URLParam")," Method")),(0,r.kt)("h2",{id:"run-demo"},"Run Demo"),(0,r.kt)(o.Z,{mdxType:"GoPlay"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-go",metastring:"{20,28,35}","{20,28,35}":!0},'package main\n\nimport (\n    "fmt"\n    "net/http"\n    "net/http/httptest"\n\n    "github.com/ggicci/httpin"\n    "github.com/go-chi/chi/v5"\n)\n\ntype ListUserReposInput struct {\n    Username   string `in:"path=username"`\n    Visibility string `in:"query=visibility"`\n    Fork       bool   `in:"query=fork"`\n}\n\nfunc ListUserRepos(rw http.ResponseWriter, r *http.Request) {\n    // Retrieve you data in one line of code!\n    input := r.Context().Value(httpin.Input).(*ListUserReposInput)\n\n    fmt.Printf("input: %#v\\n", input)\n}\n\nfunc init() {\n    // Register a directive named "path" to retrieve values from `chi.URLParam`,\n    // i.e. decode path variables.\n    httpin.UseGochiURLParam("path", chi.URLParam)\n}\n\nfunc main() {\n    router := chi.NewRouter()\n\n    // Bind input struct with handler.\n    router.With(\n        httpin.NewInput(ListUserReposInput{}),\n    ).Get("/users/{username}/repos", ListUserRepos)\n\n    r, _ := http.NewRequest("GET", "/users/ggicci/repos?visibility=public&fork=1", nil)\n\n    rw := httptest.NewRecorder()\n    router.ServeHTTP(rw, r)\n}\n'))))}h.isMDXComponent=!0}}]);
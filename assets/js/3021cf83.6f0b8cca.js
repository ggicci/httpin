"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[538],{2332:(e,t,n)=>{n.d(t,{Z:()=>c});var r=function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function s(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((r=r.apply(e,t||[])).next())}))};class a{constructor(e="/goplay"){this.proxyUrl=e}raiseForStatus(e){return r(this,void 0,void 0,(function*(){if(!e.ok){const t=yield e.text();throw new Error(t?e.statusText+": "+t:e.statusText)}}))}compile(e,t){return r(this,void 0,void 0,(function*(){const n=new FormData;n.append("version","2"),n.append("withVet","true"),n.append("body",e);const r=yield fetch(`${this.proxyUrl}/_/compile?backend=${t||""}`,{method:"POST",body:n});return yield this.raiseForStatus(r),yield r.json()}))}renderCompile(e,t,n){return r(this,void 0,void 0,(function*(){e.replaceChildren(this.renderMessage("system","Waiting for remote server..."));const r=yield this.compile(t,n);if(e.replaceChildren(),""!=r.Errors)return e.appendChild(this.renderMessage("error",r.Errors)),void e.appendChild(this.renderMessage("system","\nGo build failed."));for(const t of r.Events||[])e.appendChild(yield this.renderEvent(t));e.appendChild(this.renderMessage("system","\nProgram exited."))}))}renderEvent(e){return r(this,void 0,void 0,(function*(){var t;return e.Delay>=0&&(yield(t=e.Delay/1e6,new Promise((e=>setTimeout(e,t))))),this.renderMessage(e.Kind,e.Message)}))}renderMessage(e,t){const n=document.createElement("span");return n.classList.add(e),n.innerText=t,n}share(e,t){return r(this,void 0,void 0,(function*(){const n=yield fetch(`${this.proxyUrl}/_/share`,{method:"POST",body:e});yield this.raiseForStatus(n);const r="https://go.dev/play/p/"+(yield n.text());return t?`${r}?v=${t}`:r}))}}var i=n(4464),s=n(7294);const o="toolbar_uIxz",l="button_yMrS",p="hidden_X41c",d="https://goplay.ggicci.me",u=e=>{const{children:t,onClick:n}=e;return s.createElement("button",{className:l,onClick:n},t)},c=e=>{const{children:t}=e,n=s.useRef(null),r=s.useRef(null),l=t&&t.props&&"pre"===t.props.mdxType&&t,c=l&&l.props&&l.props.children;if(!c||"code"!==c.props.mdxType)return s.createElement("div",null,"GoPlay: the wrapped data is not a codeblock.");if(!/\blanguage-go\b/.test(c&&c.props.className))return s.createElement("div",null,"GoPlay: only go code supported.");return s.createElement(s.Fragment,null,t,s.createElement("div",{ref:n,className:p},s.createElement(i.Z,{language:"text"},s.createElement("div",{ref:r}))),s.createElement("div",{className:o},s.createElement(u,{onClick:function(){if(r.current){const e=new a(d);n.current.classList.remove(p),e.renderCompile(r.current,c.props.children.trim())}}},"Run"),s.createElement(u,{onClick:async function(){const e=new a(d),t=await e.share(c.props.children.trim());window.open(t,"_blank")}},"Try it yourself \u21e2")))}},2418:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>o,default:()=>m,frontMatter:()=>s,metadata:()=>l,toc:()=>d});var r=n(7462),a=(n(7294),n(3905)),i=n(2332);const s={sidebar_position:0,slug:"/"},o="Getting Started",l={unversionedId:"getting-started",id:"getting-started",title:"Getting Started",description:"httpin is a Go package for decoding HTTP requests into structs. We can decode",source:"@site/docs/getting-started.mdx",sourceDirName:".",slug:"/",permalink:"/httpin/",draft:!1,editUrl:"https://github.com/ggicci/httpin/edit/documentation/docs/docs/getting-started.mdx",tags:[],version:"current",sidebarPosition:0,frontMatter:{sidebar_position:0,slug:"/"},sidebar:"docsSidebar",next:{title:"query",permalink:"/httpin/directives/query"}},p={},d=[{value:"Install",id:"install",level:2},{value:"Thanks \ud83e\udd70",id:"thanks-",level:2},{value:"Quick View",id:"quick-view",level:2},{value:"Run Demo",id:"run-demo",level:2},{value:"Comparison",id:"comparison",level:2}],u={toc:d},c="wrapper";function m(e){let{components:t,...n}=e;return(0,a.kt)(c,(0,r.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"getting-started"},"Getting Started"),(0,a.kt)("p",null,"httpin is a ",(0,a.kt)("strong",{parentName:"p"},"Go")," package for ",(0,a.kt)("strong",{parentName:"p"},"decoding HTTP requests into structs"),". We can decode"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/directives/query"},"Query parameters"),", e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"?name=john&is_member=true")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/directives/header"},"Headers"),", e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"Authorization: xxx")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/directives/form"},"Form data"),", e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"username=john&password=******")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/directives/body"},"JSON/XML Body"),", e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},'POST {"name":"john"}')),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/directives/path"},"Path variables"),", e.g. ",(0,a.kt)("inlineCode",{parentName:"li"},"/users/{username}")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/advanced/upload-files"},"File uploads")),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/advanced/patch"},"Patch fields"),", i.e. tell a field from missing to empty")),(0,a.kt)("p",null,"and ",(0,a.kt)("a",{parentName:"p",href:"/directives/custom"},"more")," of an HTTP request into a struct in Go."),(0,a.kt)("h2",{id:"install"},"Install"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-shell"},"go get github.com/ggicci/httpin\n")),(0,a.kt)("h2",{id:"thanks-"},"Thanks \ud83e\udd70"),(0,a.kt)("p",null,"If you thought this package helpful, please consider ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/ggicci/httpin/stargazers"},"giving it a big star \u2b50\ufe0f"),". Thanks in advance!"),(0,a.kt)("h2",{id:"quick-view"},"Quick View"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'// Well define your data.\ntype ListUsersInput struct {\n    Page     int  `in:"query=page"`\n    PerPage  int  `in:"query=per_page"`\n    IsMember bool `in:"query=is_member"`\n}\n\nfunc ListUsers(rw http.ResponseWriter, r *http.Request) {\n    // Retrieve your data in one line of code!\n    input := r.Context().Value(httpin.Input).(*ListUsersInput)\n\n    // Do sth.\n}\n')),(0,a.kt)("h2",{id:"run-demo"},"Run Demo"),(0,a.kt)("p",null,"Take a look at the ",(0,a.kt)("strong",{parentName:"p"},"integrations")," section in the left sidebar. You may also find useful runnable demos there."),(0,a.kt)(i.Z,{mdxType:"GoPlay"},(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-go"},'package main\n\nimport (\n    "fmt"\n    "net/http"\n    "net/http/httptest"\n\n    "github.com/ggicci/httpin"\n    "github.com/go-chi/chi/v5"\n)\n\ntype ListUsersInput struct {\n    Token    string `in:"header=Authorization"`\n    IsMember bool   `in:"query=is_member"`\n    AgeRange []int  `in:"query=age_range[],age_range"`\n}\n\nfunc ListUsers(rw http.ResponseWriter, r *http.Request) {\n    input := r.Context().Value(httpin.Input).(*ListUsersInput)\n    fmt.Printf("input: %#v\\n", input)\n}\n\nfunc main() {\n    router := chi.NewRouter()\n    router.With(\n        httpin.NewInput(ListUsersInput{}),\n    ).Get("/users", ListUsers)\n\n    r, _ := http.NewRequest("GET", "/users?is_member=1&age_range=18&age_range=60", nil)\n    r.Header.Set("Authorization", "my-secret-here")\n\n    rw := httptest.NewRecorder()\n    router.ServeHTTP(rw, r)\n}\n'))),(0,a.kt)("h2",{id:"comparison"},"Comparison"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Items"),(0,a.kt)("th",{parentName:"tr",align:null},"Before (use net/http package)"),(0,a.kt)("th",{parentName:"tr",align:null},"After (use ggicci/httpin package)"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Developer Time"),(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude2b Expensive (too much parsing stuff code)"),(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude80 ",(0,a.kt)("strong",{parentName:"td"},"Faster")," (define the struct for receiving input data and leave the parsing job to httpin)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Code Repetition Rate"),(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude1e High"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"Lower"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Code Readability"),(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude1f Poor"),(0,a.kt)("td",{parentName:"tr",align:null},(0,a.kt)("strong",{parentName:"td"},"Highly readable"))),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Maintainability"),(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude21 Poor"),(0,a.kt)("td",{parentName:"tr",align:null},"\ud83d\ude0d ",(0,a.kt)("strong",{parentName:"td"},"Highly maintainable"))))))}m.isMDXComponent=!0}}]);